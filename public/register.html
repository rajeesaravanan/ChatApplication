<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Register</title>

<style>
  * {
    box-sizing: border-box;
  }

.bg-wrapper {
  position: relative;
  width: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  overflow: hidden;
}

.bg-wrapper::before {
  content: '';
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background:
    radial-gradient(circle at 20% 30%, rgba(30, 60, 114, 0.4), transparent 60%),
    radial-gradient(circle at 80% 70%, rgba(42, 82, 152, 0.4), transparent 60%);
  background-size: cover;
  animation: pulse 6s ease-in-out infinite;
  z-index: -2;
}
.bg-wrapper::after {
  content: '';
  position: absolute;
  top: 0; left: 0;
  width: 100%;
  height: 100%;
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  background-color: rgba(0, 0, 0, 0.2); /* optional soft tint */
  z-index: -1;
}


body {
  margin: 0;
  padding: 0;
background: url('https://images.unsplash.com/photo-1521737604893-d14cc237f11d?auto=format&fit=crop&w=1600&q=80') no-repeat center center fixed;
  background-size: cover;
  font-family: 'Segoe UI', sans-serif;
  background-position: center top; /* Register */

}


@keyframes pulse {
  0%, 100% {
    background-position: 20% 30%, 80% 70%;
  }
  50% {
    background-position: 25% 35%, 75% 65%;
  }
}





  #registerform {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 16px;
    padding: 35px 30px;
    width: 90%;
    max-width: 700px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.37);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    color: #ffffff;
      transition: transform 0.3s ease, box-shadow 0.3s ease;

  }

  #registerform:hover {
  transform: translateY(-5px);
  box-shadow: 0 12px 24px rgba(0, 0, 0, 0.25);
}

  #registerform h2 {
    margin-bottom: 25px;
    font-size: 28px;
    font-weight: bold;
    text-align: center;
    font-family: cursive;
    color: #ffffff;
  }

  .form-row {
    display: flex;
    gap: 16px;
    margin-bottom: 16px;
  }

  .form-col {
    flex: 1;
    display: flex;
    flex-direction: column;
  }

  label {
    font-family: cursive;
    font-weight: 500;
    font-size: 18px;
    color: #e0e0e0;
    margin-bottom: 6px;
   
  }

  input, select {
    padding: 12px;
    border: none;
    border-radius: 8px;
    background-color: rgba(255, 255, 255, 0.95);
    font-size: 14px;
    color: #333;
  }

  #registerform button {
    width: 28%;
    padding: 12px;
    background-color: #1a75ff;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    cursor: pointer;
    font-weight: bold;
    transition: background 0.3s ease;
    font-family: cursive;
  }

  #registerform button:hover {
    background-color: #004bbd;
  }

  .error-message {
  color: #ff4d4d; /* Red color */
  font-size: 14px;
  margin-top: 4px;
  font-family: monospace;
}
.input-error {
  border: 2px solid #ff4d4d !important;
}


  .form-actions {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-top: 20px;
  }

  .google-button {
    background-color: white;
    padding: 6px;
    border-radius: 50%;
    height: 40px;
    width: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.15);
  }

  .google-button img {
    height: 20px;
    width: 20px;
  }

  @media (max-width: 768px) {
    .form-row {
      flex-direction: column;
    }

    #registerform button {
      width: 100%;
    }

    .form-actions {
      flex-direction: column;
    }
  }
</style>


  </head>

  <body>
 
<div class="bg-wrapper">

    <form id="registerform" method="post" autocomplete="off">
      
      <h2
        style="font-family: cursive; font-size: xx-large; font-weight: bolder"
      >
        Register
      </h2>

      <div class="form-row">
          <div class="form-col">
      <label
        for="name"
        style="font-family: cursive; font-size: large; font-weight: bolder"
        >Name:</label
      >
      <input
        type="text"
        id="name"
        name="name"
        required autocomplete="off"
        onblur="validateInputField(this)"
      />
          </div><br />
            <div class="form-col">

      <label
        for="username"
        style="font-family: cursive; font-size: large; font-weight: bolder"
        >User name:</label
      >
      <input
        type="text"
        id="username"
        name="username"
        required autocomplete="off"
        onblur="validateInputField(this)"
      />
      </div>
      </div><br />

      <div class="form-row">
  <div class="form-col">

      <label
      for="email"
      style="font-family: cursive; font-size: large; font-weight: bolder"
      >e-mail:</label
    >

    <input
      type="email"
      id="email"
      name="email"
      required autocomplete="off"
      onblur="validateInputField(this)"
    /></div><br />

      <div class="form-col">

      <label
        for="password"
        style="font-family: cursive; font-size: large; font-weight: bolder"
        >Password:</label
      >

      <input
        type="password"
        id="password"
        name="password"
        required autocomplete="off"
        onblur="validateInputField(this)"
      />
      </div></div><br />

      <div class="form-row">
          <div class="form-col">



      <label
        for="gender"
        style="font-family: cursive; font-size: large; font-weight: bolder"
      >
        Gender:
      </label>
      <select
        id="gender"
        name="gender"
        required
        style="
          width: 100%;
          padding: 8px;
          margin-bottom: 15px;
          border: 1px solid #ccc;
          border-radius: 4px;
          box-sizing: border-box;
        "
      >
        <option value="">Select Gender</option>
        <option value="male">Male</option>
        <option value="female">Female</option>
      </select>
          </div>

            <div class="form-col">

    
      <label
        for="education"
        style="font-family: cursive; font-size: large; font-weight: bolder"
        >Educational Qualification:</label
      >
      <input
        type="text"
        id="education"
        name="education"
        required autocomplete="off"
        onblur="validateInputField(this)"
      />
            </div></div><br />

    
      <div style="display: flex; justify-content: center; align-items: center; gap: 10px; margin-top: 20px;">
        <button type="submit">Register</button>
        <button onclick="registerWithGoogle()" 
          style="border: none; background-color: white; padding: 4px; border-radius: 50%; 
                 box-shadow: 0 1px 3px rgba(0,0,0,0.15); cursor: pointer; 
                 height: 36px; width: 36px; display: flex; align-items: center; justify-content: center;">
          <img src="https://developers.google.com/identity/images/g-logo.png" 
               style="height: 18px; width: 18px;" alt="Google Logo" />
        </button>
      </div>
      </div>

    </form>

      <svg viewBox="0 0 1440 320" style="position: absolute; bottom: 0; width: 100%; z-index: -3;">
    <path fill="#203a43" fill-opacity="0.3" d="M0,192L80,176C160,160,320,128,480,144C640,160,800,224,960,224C1120,224,1280,160,1360,128L1440,96L1440,320L1360,320C1280,320,1120,320,960,320C800,320,640,320,480,320C320,320,160,320,80,320L0,320Z"></path>
  </svg>

    <p id="responseMessage"></p>

    <script>



  window.addEventListener("pageshow", function () {
  // Clear storage
  localStorage.clear();
  sessionStorage.clear();

  // Clear all inputs and selects
  const inputs = document.querySelectorAll("input, select");
  inputs.forEach((input) => {
    if (input.type !== "button" && input.type !== "submit") {
      input.value = "";
    }
  });

  // Prevent back navigation
  history.pushState(null, null, location.href);
  window.onpopstate = function () {
    history.go(1);
  };
});



    function registerWithGoogle() {
    window.location.href = "http://redirectmeto.com/http://192.168.1.128:2700/auth/google?prompt=select_account&access_type=offline&hd=*";
  }

      
      function validateInputField(inputElement) {
        const value = inputElement.value;
        const trimmed = value.trim();

        let errorSpan = inputElement.nextElementSibling;
        if (!errorSpan || !errorSpan.classList.contains("error-message")) {
          errorSpan = document.createElement("span");
          errorSpan.className = "error-message";
          inputElement.insertAdjacentElement("afterend", errorSpan);

        }

        if (trimmed === "") {
          errorSpan.textContent = "Please fill out this field";
        } else if (/ {2,}/.test(value) || value !== trimmed) {
          errorSpan.textContent =
            "Invalid input";
                inputElement.classList.add("input-error");

        } else {
          errorSpan.textContent = "";
              inputElement.classList.remove("input-error");

        }
      }

      document
        .getElementById("registerform")
        .addEventListener("submit", async (event) => {
          event.preventDefault();

          const name = document.getElementById("name").value;
          const username = document.getElementById("username").value;
          const password = document.getElementById("password").value;
          const email = document.getElementById("email").value;
          const gender = document.getElementById("gender").value;
          const education = document.getElementById("education").value;

          const fields = { name, username, password, email, education };

          // Step 1: Validate each input
          for (const [fieldName, fieldValue] of Object.entries(fields)) {
            const trimmed = fieldValue.trim();

            // Disallow empty or only-space values
            if (trimmed === "") {
              alert(
                `Invalid input in "${fieldName}". Only valid characters allowed. Input cannot be empty or just spaces.`
              );
              document.getElementById("password").value = ""; //  Clear password on error

              return;
            }

            // Disallow leading/trailing or multiple consecutive spaces
            if (/ {2,}/.test(fieldValue) || fieldValue !== trimmed) {
              alert(`Invalid input in "${fieldName}". `);
              document.getElementById("password").value = ""; 

              return;
            }
          }

          //  Step 3: Password length check
          if (password.length < 6) {
            alert("Password must be at least 6 characters long.");
            document.getElementById("password").value = ""; 

            return;
          }

          try {
            const response = await fetch(
              "http://192.168.1.128:2700/user/register",
              {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify({
                  name,
                  username,
                  password,
                  email,
                  education,
             
                  gender,
                }),
              }
            );

            const responseMessage = document.getElementById("responseMessage");

            if (response.ok) {
              const result = await response.json();
              document.getElementById("responseMessage").textContent =
                result.msg;
              setTimeout(() => {
                window.location.href = "login.html"; // Change 'login.html' to your actual login page URL
              }, 2000);

              alert("User Registered Successfully");
            } else {
              const errorData = await response.json();
              alert(errorData.msg || "Registration failed.");
            }
          } catch (err) {
            console.error(err);

            alert("User already exists");
          }
        });




    


    </script>


  </body>
</html>
